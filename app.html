<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Grupo DV</title>

<meta name="viewport"
      content="width=device-width,
               initial-scale=1,
               maximum-scale=1,
               user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

<style>
:root{
  --bg:#0b0b0b;
  --border:#242424;
  --text:#f5f5f5;
  --muted:#9ca3af;
  --gold:#d4af37;
  --top:56px;
  --bottom:72px;
}

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Inter,system-ui;
}

html,body{
  width:100%;
  height:100%;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}

/* TOPO */
.topbar{
  position:fixed;
  top:0;left:0;right:0;
  height:var(--top);
  background:#0b0b0b;
  border-bottom:1px solid var(--border);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 16px;
  z-index:10;
}

.topbar h1{
  font-size:16px;
  font-weight:800;
  letter-spacing:.6px;
}

/* AVATAR */
.avatar{
  width:36px;
  height:36px;
  border-radius:50%;
  background-image:url('leo.png');
  background-size:cover;
  background-position:center;
  border:2px solid var(--gold);
}

/* CONTEÚDO */
.content{
  position:fixed;
  top:var(--top);
  bottom:var(--bottom);
  left:0;right:0;
  background:#000;
}

iframe{
  width:100%;
  height:100%;
  border:none;
}

/* NAVBAR */
.navbar{
  position:fixed;
  bottom:0;left:0;right:0;
  height:var(--bottom);
  background:#0b0b0b;
  border-top:1px solid var(--border);
  display:grid;
  grid-template-columns:repeat(5,1fr);
}

.nav-item{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  font-size:11px;
  color:var(--muted);
  cursor:pointer;
}

.nav-item i{
  font-size:22px;
}

.nav-item.active{
  color:var(--gold);
}
</style>
</head>

<body>

<!-- TOPO -->
<div class="topbar">
  <h1>GRUPO DV</h1>
  <div class="avatar"></div>
</div>

<!-- CONTEÚDO -->
<div class="content">
  <iframe id="frame"></iframe>
</div>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="nav-item" data-page="dashboard.html">
    <i class="ri-dashboard-line"></i>
    Dashboard
  </div>

  <div class="nav-item" data-page="entradas.html">
    <i class="ri-arrow-down-circle-line"></i>
    Entradas
  </div>

  <div class="nav-item" data-page="saidas.html">
    <i class="ri-arrow-up-circle-line"></i>
    Saídas
  </div>

  <div class="nav-item" data-page="relatorios.html">
    <i class="ri-bar-chart-line"></i>
    Relatórios
  </div>

  <div class="nav-item" data-page="config.html">
    <i class="ri-settings-3-line"></i>
    Config
  </div>
</nav>

<script>
/* ================= CACHE CONFIG ================= */
const CACHE_TTL = 5 * 60 * 1000; // 5 minutos
const PAGE_KEY = "APP_PAGE_CACHE";
const TS_KEY = "APP_PAGE_CACHE_TS";

const frame = document.getElementById("frame");
const navItems = document.querySelectorAll(".nav-item");

/* ================= FUNÇÕES ================= */
function setActive(page){
  navItems.forEach(i=>{
    i.classList.toggle("active", i.dataset.page === page);
  });
}

function carregarPagina(page, force=false){
  const now = Date.now();
  const ts = Number(localStorage.getItem(TS_KEY));

  const cacheValido = ts && (now - ts < CACHE_TTL);

  if(!force && cacheValido && localStorage.getItem(PAGE_KEY) === page){
    // NÃO recarrega iframe
    setActive(page);
    return;
  }

  frame.src = page;
  localStorage.setItem(PAGE_KEY, page);
  localStorage.setItem(TS_KEY, now);
  setActive(page);
}

/* ================= NAV CLICK ================= */
navItems.forEach(item=>{
  item.onclick = ()=>{
    carregarPagina(item.dataset.page);
  };
});

/* ================= INIT ================= */
(function init(){
  const now = Date.now();
  const ts = Number(localStorage.getItem(TS_KEY));
  const page = localStorage.getItem(PAGE_KEY) || "dashboard.html";

  const cacheExpirou = !ts || (now - ts > CACHE_TTL);

  carregarPagina(page, cacheExpirou);
})();
</script>

</body>
</html>
